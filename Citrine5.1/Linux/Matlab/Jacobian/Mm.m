clear;
clc;
syms u0old v0old w0old T0old Sn0old Sb0old Phi0old Theta0old O2mega0old O3mega0old real;
syms u0new v0new w0new T0new Sn0new Sb0new Phi0new Theta0new O2mega0new O3mega0new real;
syms u1old v1old w1old T1old Sn1old Sb1old Phi1old Theta1old O2mega1old O3mega1old real;
syms u1new v1new w1new T1new Sn1new Sb1new Phi1new Theta1new O2mega1new O3mega1new real;
syms M ma E A I pi rho d0 Cdt Cdn Cdb real;
syms deltaT deltaS real;
syms Vx Vy Vz real;
syms Gx Gy Gz real;

%[1] = M*u0old*cos(Theta0old) + M*w0old*sin(Theta0old) + ma*Vy*sin(Phi0old)+ ma*Vx*cos(Phi0old)
%[2] = -M*u0old -ma*Vx*cos(Phi0old)*cos(Theta0old) - ma*Vy*sin(Phi0old)*cos(Theta0old) + ma*Vz*sin(Theta0old)
%[3] = -M*v0old*sin(Theta0old) + ma*Vx*sin(Phi0old)*sin(Theta0old) - ma*Vy*cos(Phi0old)*sin(Theta0old)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%M0old = str2sym('[M,0,0,0,0,0,M*w0old,-M*cos(Theta0old)*v0old,0,0;0,M+ma,0,0,0,0,0,[1],0,0;0,0,M+ma,0,0,0,[2],[3],0,0;0,0,0,(1/(E*A)),0,0,0,0,0,0;0,0,0,0,0,0,0,(1+(T0old/(E*A)))*cos(Theta0old),0,0;0,0,0,0,0,0,(1+(T0old/(E*A))),0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0;]');

M0old = str2sym(['[M, 0, 0, 0, 0, 0, M*w0old, -M*cos(Theta0old)*v0old, 0, 0; ' ...
                 '0, M+ma, 0, 0, 0, 0, 0, M*u0old*cos(Theta0old) + M*w0old*sin(Theta0old) + ma*Vy*sin(Phi0old) + ma*Vx*cos(Phi0old), 0, 0; ' ...
                 '0, 0, M+ma, 0, 0, 0, -M*u0old - ma*Vx*cos(Phi0old)*cos(Theta0old) - ma*Vy*sin(Phi0old)*cos(Theta0old) + ma*Vz*sin(Theta0old), -M*v0old*sin(Theta0old) + ma*Vx*sin(Phi0old)*sin(Theta0old) - ma*Vy*cos(Phi0old)*sin(Theta0old), 0, 0; ' ...
                 '0, 0, 0, (1/(E*A)), 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, (1+(T0old/(E*A)))*cos(Theta0old), 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, (1+(T0old/(E*A))), 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0]']);

M1old = str2sym(['[M, 0, 0, 0, 0, 0, M*w1old, -M*cos(Theta1old)*v1old, 0, 0; ' ...
                 '0, M+ma, 0, 0, 0, 0, 0, M*u1old*cos(Theta1old) + M*w1old*sin(Theta1old) + ma*Vy*sin(Phi1old) + ma*Vx*cos(Phi1old), 0, 0; ' ...
                 '0, 0, M+ma, 0, 0, 0, -M*u1old - ma*Vx*cos(Phi1old)*cos(Theta1old) - ma*Vy*sin(Phi1old)*cos(Theta1old) + ma*Vz*sin(Theta1old), -M*v1old*sin(Theta1old) + ma*Vx*sin(Phi1old)*sin(Theta1old) - ma*Vy*cos(Phi1old)*sin(Theta1old), 0, 0; ' ...
                 '0, 0, 0, (1/(E*A)), 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, (1+(T1old/(E*A)))*cos(Theta1old), 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, (1+(T1old/(E*A))), 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0]']);

M0new = str2sym(['[M, 0, 0, 0, 0, 0, M*w0new, -M*cos(Theta0new)*v0new, 0, 0; ' ...
                 '0, M+ma, 0, 0, 0, 0, 0, M*u0new*cos(Theta0new) + M*w0new*sin(Theta0new) + ma*Vy*sin(Phi0new) + ma*Vx*cos(Phi0new), 0, 0; ' ...
                 '0, 0, M+ma, 0, 0, 0, -M*u0new - ma*Vx*cos(Phi0new)*cos(Theta0new) - ma*Vy*sin(Phi0new)*cos(Theta0new) + ma*Vz*sin(Theta0new), -M*v0new*sin(Theta0new) + ma*Vx*sin(Phi0new)*sin(Theta0new) - ma*Vy*cos(Phi0new)*sin(Theta0new), 0, 0; ' ...
                 '0, 0, 0, (1/(E*A)), 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, (1+(T0new/(E*A)))*cos(Theta0new), 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, (1+(T0new/(E*A))), 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0]']);

M1new = str2sym(['[M, 0, 0, 0, 0, 0, M*w1new, -M*cos(Theta1new)*v1new, 0, 0; ' ...
                 '0, M+ma, 0, 0, 0, 0, 0, M*u1new*cos(Theta1new) + M*w1new*sin(Theta1new) + ma*Vy*sin(Phi1new) + ma*Vx*cos(Phi1new), 0, 0; ' ...
                 '0, 0, M+ma, 0, 0, 0, -M*u1new - ma*Vx*cos(Phi1new)*cos(Theta1new) - ma*Vy*sin(Phi1new)*cos(Theta1new) + ma*Vz*sin(Theta1new), -M*v1new*sin(Theta1new) + ma*Vx*sin(Phi1new)*sin(Theta1new) - ma*Vy*cos(Phi1new)*sin(Theta1new), 0, 0; ' ...
                 '0, 0, 0, (1/(E*A)), 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, (1+(T1new/(E*A)))*cos(Theta1new), 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, (1+(T1new/(E*A))), 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ' ...
                 '0, 0, 0, 0, 0, 0, 0, 0, 0, 0]']);



